!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@nowzoo/sheetload"),require("@angular/common/http"),require("@angular/common")):"function"==typeof define&&define.amd?define("@nowzoo/ngx-highlight-js",["exports","@angular/core","@nowzoo/sheetload","@angular/common/http","@angular/common"],t):t((e.nowzoo=e.nowzoo||{},e.nowzoo["ngx-highlight-js"]={}),e.ng.core,null,e.ng.common.http,e.ng.common)}(this,function(e,t,o,n,i){"use strict";var r=new t.InjectionToken("The base url for highlight.js"),s=new t.InjectionToken("The default theme for highlight.js"),a=function(){function e(e,t){this._defaultTheme=e,this._jsURL=t,this._theme="default",this._initializedPromise=null,this._linkEl=null,this._theme=e}return e.prototype.initialized=function(){return this._initializedPromise||(this._initializedPromise=this.loadTheme(this._theme)),this._initializedPromise},e.prototype.loadTheme=function(e){var t=this,n=this._jsURL+"/styles/"+e+".min.css";return o.Sheetload.load(n).then(function(e){t._linkEl&&t._linkEl.remove(),t._linkEl=e,t._linkEl.removeAttribute("disabled")})},Object.defineProperty(e.prototype,"theme",{get:function(){return this._theme},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[s]}]},{type:String,decorators:[{type:t.Inject,args:[r]}]}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(s),t.inject(r))},token:e,providedIn:"root"}),e}(),h=function(){function e(e){this._jsURL=e,this._hljs=null,this._loadedLanguages=new Map}return e.prototype.loaded=function(){var i=this;return this._loadedPromise||(this._loadedPromise=new Promise(function(e,t){var n=i._jsURL+"/highlight.min.js";o.Scriptload.load(n).then(function(){setTimeout(function(){i._hljs=window.hljs,e(i._hljs)},10)})["catch"](t)})),this._loadedPromise},e.prototype.loadLanguage=function(e){var t=this._loadedLanguages.get(e);if(t)return t;if(this._hljs&&-1<this._hljs.listLanguages().indexOf(e))return t=Promise.resolve(),this._loadedLanguages.set(e,t),t;var n=this._jsURL+"/languages/"+e+".min.js";return t=this.loaded().then(function(){return o.Scriptload.load(n)}),this._loadedLanguages.set(e,t),t},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[r]}]}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(r))},token:e,providedIn:"root"}),e}(),l=function(){function e(e,t){this.themeService=e,this.scriptService=t}return Object.defineProperty(e.prototype,"theme",{get:function(){return this.themeService._theme},enumerable:!0,configurable:!0}),e.prototype.loaded=function(){var t=this;if(this._loadedPromise)return this._loadedPromise;var e=[this.scriptService.loaded(),this.themeService.initialized()];return this._loadedPromise=Promise.all(e).then(function(e){return t._hljs=e[0],t._hljs}),this._loadedPromise},e.prototype.loadLanguage=function(e){return this.scriptService.loadLanguage(e)},e.prototype.loadTheme=function(e){return this.themeService.loadTheme(e)},e.prototype.highlight=function(e,t){var n=this;return this.loaded().then(function(){return n.loadLanguage(e)}).then(function(){return n._hljs.highlight(e,t,!0).value})},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a},{type:h}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(a),t.inject(h))},token:e,providedIn:"root"}),e}(),u=function(){function e(e,t){this.service=e,this.http=t,this.highlightedHTML="",this.error=null,this.afterInit=!1}return e.prototype.ngOnInit=function(){this.onChange(),this.afterInit=!0},e.prototype.ngOnChanges=function(e){this.afterInit&&this.onChange()},e.prototype.fetchText=function(){var e=this;return this.url?new Promise(function(t,n){e.http.get(e.url,{responseType:"text"}).subscribe(function(e){return t(e)},function(e){return n(e)})}):Promise.resolve(this.code||"")},e.prototype.onChange=function(){var t=this;this.error=null,this.isInitializing=!0,this.fetchText().then(function(e){return t.service.highlight(t.lang,e)}).then(function(e){t.highlightedHTML=e,t.isInitializing=!1})["catch"](function(e){t.error=e.toString(),t.isInitializing=!1})},e.decorators=[{type:t.Component,args:[{selector:"ngx-highlight-js",exportAs:"ngxHighlightJs",template:'<pre><code\n      [ngClass]="\'hljs \' + lang"\n      [innerHTML]="highlightedHTML"></code></pre>'}]}],e.ctorParameters=function(){return[{type:l},{type:n.HttpClient}]},e.propDecorators={code:[{type:t.Input}],url:[{type:t.Input}],lang:[{type:t.Input}]},e}(),c=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[a,h,l,{provide:r,useValue:"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0"},{provide:s,useValue:"default"}]}},e.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule,n.HttpClientModule],declarations:[u],exports:[u]}]}],e}();e.NGX_HIGHLIGHT_JS_URL=r,e.NGX_HIGHLIGHT_JS_DEFAULT_THEME=s,e.NgxHighlightJsService=l,e.NgxHighlightJsModule=c,e.ɵb=h,e.ɵa=a,e.ɵc=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=nowzoo-ngx-highlight-js.umd.min.js.map